{% extends "base.html" %}
{% load static %}

{% block title %}{{ pelkat.slug }}{% endblock title %}
{% block hero_banner %}{{ pelkat.banner.url }}{% endblock hero_banner %}
{% block hero_title %}{{ pelkat.name }}{% endblock hero_title %}
{% block hero_desc %}{% endblock hero_desc %}
{% block content %}
   
        <!--========== PAGE LAYOUT ==========-->
        <!-- Features -->
        <div class="section-seperator">
            <div class="content-lg container">
                <h2>Kegiatan</h2>
                <div class="row">
                    {% for event in pelkat.events.all %}
                        <div class="col-sm-4 sm-margin-b-50">
                            <div class="wow fadeInLeft" data-wow-duration=".3" data-wow-delay=".{{ forloop.revcounter0|add:"1" }}s">
                                {% if event.image %}
                                <img 
                                    src="{{ event.image.url }}" 
                                    alt="{{ event.title }}"
                                    class="img-responsive img-rounded"
                                    style="width:200%; height:500px; object-fit:cover; border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin-bottom:15px;"
                                >
                            {% endif %}
                                <h3>{{ event.title }}</h3>
                                <p>{{ event.description|striptags|truncatewords:20 }}</p>
                                <a class="link" href="{% url 'pelkat-event-detail' pelkat.slug event.id %}">Lihat Detail</a>
                            </div>
                        </div>
                    {% empty %}
                        <div class="col-sm-12">
                            <p>Belum ada event untuk pelkat ini.</p>
                        </div>
                    {% endfor %}
                </div>
                <!--// end row -->
            </div>
        </div>

        <!-- End Features -->

        <!-- About -->
        <div class="content-lg container">
        <div class="row margin-b-20">
            <div class="col-sm-6">
                <h2>Tentang {{ pelkat.name }}</h2>
            </div>
        </div>
        <!--// end row -->

        <div class="row align-items-center">
            <!-- Gambar: muncul di kanan saat desktop, di atas saat mobile -->
            <div class="col-sm-4 col-sm-offset-1 order-1 order-sm-2">
                <img class="img-responsive" src="{{ pelkat.logo.url }}" alt="Logo {{ pelkat.name }}">
            </div>

            <!-- Teks: muncul di kiri saat desktop, di bawah saat mobile -->
            <div class="col-sm-7 sm-margin-b-50 order-2 order-sm-1">
                <div class="margin-b-30">
                    <p>{{ pelkat.description|safe }}</p>
                </div>
            </div>
        </div>
    <!--// end row -->
</div>

        <!-- End About -->

       <!-- Galeri Foto Pelkat -->
        <div class="bg-color-sky-light" data-auto-height="true">
            <div class="content-lg container">
                 <h2>Galeri Foto</h2>
                <div class="row row-space-1 margin-b-2">
                    {% for img in gallery %}
                    <div class="col-sm-4 sm-margin-b-2">
                        <div class="wow fadeInLeft" data-wow-duration=".3" data-wow-delay=".{{ forloop.counter }}s">
                            <div class="service" data-height="height">
                                <div class="service-element">
                                    <img src="{{ img.image.url }}" alt="{{ img.caption }}" class="img-responsive" style="object-fit: cover; height: 200px; width: 100%; border-radius: 6px;">
                                </div>
                                <div class="service-info">
                                    {% if img.caption %}
                                        <p class="margin-b-5">{{ img.caption }}</p>
                                    {% else %}
                                        <p class="margin-b-5 text-muted">Dokumentasi kegiatan</p>
                                    {% endif %}
                                </div>
                                <a href="{{ img.image.url }}" class="content-wrapper-link" target="_blank"></a>
                            </div>
                        </div>
                    </div>

                    {% if forloop.counter|divisibleby:3 %}
                        </div><div class="row row-space-1 margin-b-2">
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        <!-- End Galeri Foto Pelkat -->

        <!-- Jadwal Kegiatan -->
        <div class="content-lg container">
            <div class="row">
                <div class="col-sm-9">
                    <h2>Jadwal Kegiatan {{ pelkat.name }}</h2>

                    <!-- Swiper Slider for Schedules -->
                    <div class="swiper-slider swiper-testimonials">
                        <div class="swiper-wrapper">
                            {% for schedule in schedules %}
                            <div class="swiper-slide">
                                <blockquote class="blockquote">
                                    <div class="margin-b-20">
                                        <strong>{{ schedule.title }}</strong><br>
                                        <span class="text-muted">Hari {{ schedule.day }}, pukul {{ schedule.time|time:"H:i" }}</span><br>
                                        {% if schedule.location %}
                                            <span class="text-muted">Lokasi: {{ schedule.location }}</span><br>
                                        {% endif %}
                                    </div>
                                    {% if schedule.description %}
                                    <div class="margin-b-20">
                                        {{ schedule.description | safe }}
                                    </div>
                                    {% endif %}
                                    <p><span class="fweight-700 color-link">Pelkat {{ pelkat.name }}</span></p>
                                </blockquote>
                            </div>
                            {% endfor %}
                        </div>
                        <!-- End Swiper Wrapper -->
                    </div>
                    <!-- End Swiper -->
                </div>
            </div>
        </div>
        <!-- End Jadwal Kegiatan -->

        <!-- Pengurus Pelkat -->
        <div class="bg-color-sky-light">
            <div class="content-lg container">
                <div class="row margin-b-40">
                    <div class="col-sm-6">
                        <h2>Struktur Pengurus</h2>
                        <p>Berikut adalah para pengurus Pelayanan Kategorial {{ pelkat.name }} yang menjalankan tugas dan pelayanan.</p>
                    </div>
                </div>
                <!--// end row -->

                <div class="row">
                    {% for person in pengurus %}
                    <div class="col-sm-4 sm-margin-b-50">
                        <div class="bg-color-white margin-b-20">
                            <div class="wow zoomIn" data-wow-duration=".3" data-wow-delay=".{{ forloop.counter }}s">
                                {% if person.photo %}
                                    <img class="img-responsive" src="{{ person.photo.url }}" alt="{{ person.name }}"
                                        style="width:100%; height:350px; object-fit:cover; object-position:center; border-radius:8px;">
                                {% else %}
                                    <img class="img-responsive" src="{% static 'img/placeholder-profile.jpg' %}" alt="No Photo"
                                        style="width:100%; height:350px; object-fit:cover; object-position:center; border-radius:8px;">
                                {% endif %}
                            </div>
                        </div>
                        <h4>
                        <a href="#">{{ person.name }}</a>
                        <span class="text-uppercase margin-l-20" style="color:#333; font-weight:500;">{{ person.position }}</span>
                        </h4>
                    </div>
                    {% endfor %}
                </div>
                <!--// end row -->
            </div>
        </div>
        <!-- End Pengurus Pelkat -->

        <!-- Kontak Pengurus -->
        <div class="bg-color-white">
            <div class="content-lg container">
                <div class="row margin-b-40">
                    <div class="col-sm-6">
                        <h2>Kontak Informasi</h2>
                        <p>Silakan hubungi pengurus berikut jika Anda ingin mendapatkan informasi lebih lanjut tentang kegiatan Pelkat {{ pelkat.name }}.</p>
                    </div>
                </div>
                <div class="row">
                    {% for person in pengurus %}
                        {% if person.contact_number %}
                        <div class="col-sm-4 sm-margin-b-30">
                            <div class="bg-color-sky-light p-4 rounded text-center">
                                <h4>{{ person.name }}</h4>
                                <p class="text-muted">{{ person.position }}</p>
                                <a class="btn btn-success" href="https://wa.me/{{ person.contact_number|cut:' '|cut:'+'|cut:'-' }}" target="_blank">
                                    <i class="icon-social-whatsapp"></i> Hubungi via WhatsApp
                                </a>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <br>
                <!-- Tombol Kembali -->
                <div class="row margin-t-30">
                    <div class="col-sm-12">
                        <a href="{% url 'pelkat-index' %}" class="btn btn-secondary">← Kembali ke Daftar Pelayanan Kategorial</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Kontak Pengurus -->
        <!--========== END PAGE LAYOUT ==========-->

       
{% endblock %}
